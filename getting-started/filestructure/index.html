<!DOCTYPE HTML>
<html>
    <head>
      <meta charset="UTF-8">
        <link rel="stylesheet" href="https://docs.gluon.dev/main.css">
      
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
        <title> Understanding the file structure |  </title> 
    </head>
    <body>

      
    <script>
         fetch('https://api.github.com/repos/pulse-browser/gluon/releases/latest')
          .then((response) => {
            return response.json();
          })
          .then((data) => {
            let release_name = data.name;
            let html_url = data.html_url;
            release.innerHTML = `<a href='${html_url}'>${release_name}</a>`;
          });
    </script>
      
    <main>

      

        <nav>
          
            <a href="https:&#x2F;&#x2F;docs.gluon.dev">
            <img src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Package/3D/package_3d.png" alt="" />
                </a>
            
            
          

          
            <div id="release"></div>
          
  
  <a href="javascript:void(0);" onclick="burger()" id="mobile" class="ms-Icon--GlobalNavButton"></a>
    <div id="trees">
               
            
                 
            
 
        <input class="tree-toggle" type="checkbox" id="getting-started" 
        checked />
        <label class="tree-toggle-label" for="getting-started">Getting Started</label>
                        
        <ul class="subtree">
                
                                <li >
                                    <a href="https://docs.gluon.dev/getting-started/overview/">Setting up your project</a>
                                </li>

                            
    
                                <li class="active">
                                    <a href="https://docs.gluon.dev/getting-started/filestructure/">Understanding the file structure</a>
                                </li>

                             
                                
  
  
    
    
      
      
    
      
      
    
      
      
    
      
      
    
  

  
      <ul id="toc">
        
          <li><a href="https://docs.gluon.dev/getting-started/filestructure/#understanding-the-file-structure">Understanding the file structure</a>
          
          <ul>        
            
            <li><a href="https://docs.gluon.dev/getting-started/filestructure/#gluon-json">gluon.json</a></li>
            
            <li><a href="https://docs.gluon.dev/getting-started/filestructure/#configs">Configs</a></li>
            
            <li><a href="https://docs.gluon.dev/getting-started/filestructure/#src">src&#x2F;</a></li>
            
            <li><a href="https://docs.gluon.dev/getting-started/filestructure/#engine">engine&#x2F;</a></li>
            
         </ul>
    
        </li>
    
      </ul>
    

                        
    
    
                                <li >
                                    <a href="https://docs.gluon.dev/getting-started/userchrome/">Customizing Your Browser&#x27;s UI</a>
                                </li>

                            
    
    </ul>         
    
                 
            
 
        <input class="tree-toggle" type="checkbox" id="guides" 
         />
        <label class="tree-toggle-label" for="guides">Guides</label>
                        
        <ul class="subtree">
                
                                <li >
                                    <a href="https://docs.gluon.dev/guides/windows/">Preparing Windows</a>
                                </li>

                            
    
                                <li >
                                    <a href="https://docs.gluon.dev/guides/removingpocket/">Removing pocket</a>
                                </li>

                            
    
                                <li >
                                    <a href="https://docs.gluon.dev/guides/includingaddons/">Including addons</a>
                                </li>

                            
    
                                <li >
                                    <a href="https://docs.gluon.dev/guides/branding/">Branding your browser</a>
                                </li>

                            
    
                                <li >
                                    <a href="https://docs.gluon.dev/guides/autoupdates/">Automatic updates</a>
                                </li>

                            
    
    </ul>         
    
                 
            
 
        <input class="tree-toggle" type="checkbox" id="reference" 
         />
        <label class="tree-toggle-label" for="reference">Reference</label>
                        
        <ul class="subtree">
                
                                <li >
                                    <a href="https://docs.gluon.dev/reference/config/">`gluon.json` Reference</a>
                                </li>

                            
    
    </ul>         
    
    </div>    
  </nav>
    

<article>
 
  
  <div id="on_right">
    <span id="search-ico" class="ms-Icon--Search"></span>
  </div>
    <div class="search-container">
          <input id="search" type="search" placeholder="Search as you type...">
            <div class="search-results">
              <div class="search-results__header"></div>
                <ul class="search-results__items"></ul>
              </div>
    </div>
         

  <div id="wrap">
     <h1 id="understanding-the-file-structure">Understanding the file structure</h1>
<p>Lets take a look at the file structure of your project. It should look something like this:</p>
<pre style="background-color:#2b303b;">
<code class="language-filesystem" data-lang="filesystem"><span style="color:#c0c5ce;">├─  .gitignore
├─  gluon.json
├─  configs
│   ├─  common
│   │   └─  mozconfig
│   ├─  linux
│   │   └─  mozconfig
│   ├─  macos
│   │   └─  mozconfig
│   └─  windows
│       └─  mozconfig
├─  src
│   ├─  README.md
│   └─  browser
│       └─  themes
│           ├─  custom
│           │   ├─  linux
│           │   │   └─  linux.inc.css
│           │   ├─  macos
│           │   │   └─  macos.inc.css
│           │   ├─  shared
│           │   │   └─  shared.inc.css
│           │   └─  windows
│           │       └─  windows.inc.css
│           ├─  linux
│           │   ├─  browser-css.patch
│           │   └─  jar-mn.patch
│           ├─  osx
│           │   ├─  browser-css.patch
│           │   └─  jar-mn.patch
│           ├─  shared
│           │   ├─  browser-shared-css.patch
│           │   └─  jar-inc-mn.patch
│           └─  windows
│               ├─  browser-css.patch
│               └─  jar-mn.patch
├─  .gluon
│   └─  ...
└─  engine
    └─  ...
</span></code></pre>
<p>Whilst this may seem large (especially if you look inside of the <code>engine</code>) directory, it is all fairly manageable.</p>
<h2 id="gluon-json">gluon.json</h2>
<p>The primary configuration file for your project is the <code>gluon.json</code> file. This is where you will put information about your browser so Gluon can build it correctly. It should look something like this:</p>
<pre style="background-color:#2b303b;">
<code class="language-json" data-lang="json"><span style="color:#c0c5ce;">{
  &quot;</span><span style="color:#a3be8c;">name</span><span style="color:#c0c5ce;">&quot;: &quot;</span><span style="color:#a3be8c;">Gluon Example Browser</span><span style="color:#c0c5ce;">&quot;,
  &quot;</span><span style="color:#a3be8c;">vendor</span><span style="color:#c0c5ce;">&quot;: &quot;</span><span style="color:#a3be8c;">Fushra</span><span style="color:#c0c5ce;">&quot;,
  &quot;</span><span style="color:#a3be8c;">appId</span><span style="color:#c0c5ce;">&quot;: &quot;</span><span style="color:#a3be8c;">dev.gluon.example</span><span style="color:#c0c5ce;">&quot;,
  &quot;</span><span style="color:#a3be8c;">binaryName</span><span style="color:#c0c5ce;">&quot;: &quot;</span><span style="color:#a3be8c;">gluon-example-browser</span><span style="color:#c0c5ce;">&quot;,

  &quot;</span><span style="color:#a3be8c;">version</span><span style="color:#c0c5ce;">&quot;: {
    &quot;</span><span style="color:#a3be8c;">product</span><span style="color:#c0c5ce;">&quot;: &quot;</span><span style="color:#a3be8c;">firefox</span><span style="color:#c0c5ce;">&quot;,
    &quot;</span><span style="color:#a3be8c;">version</span><span style="color:#c0c5ce;">&quot;: &quot;</span><span style="color:#a3be8c;">102.0.1</span><span style="color:#c0c5ce;">&quot;
  },

  &quot;</span><span style="color:#a3be8c;">buildOptions</span><span style="color:#c0c5ce;">&quot;: {
    &quot;</span><span style="color:#a3be8c;">windowsUseSymbolicLinks</span><span style="color:#c0c5ce;">&quot;: </span><span style="color:#d08770;">false
  </span><span style="color:#c0c5ce;">}
}
</span></code></pre>
<p>Up the top of the config file, we have general information about the browser you are building. This includes its name, the vendor creating it, its appId, and the name of the binary that will be output.</p>
<p>The <code>version</code> key is used to specify information about the product you are building. <code>product</code> is the Firefox branch you are building against. <code>version</code> is the version of Firefox you are building against, which will vary with the branch. Here <code>firefox</code> refers to the stable branch of Firefox.</p>
<p><code>buildOptions</code> provides a number of internal toggles for how Gluon builds your project.</p>
<h2 id="configs">Configs</h2>
<p>The configs folder stores a combination of config files that are required by Firefox and assets required by Gluon. By default there are only <a href="https://firefox-source-docs.mozilla.org/build/buildsystem/mozconfigs.html"><code>mozconfig</code> files</a>, Gluon should generate most parts of this config for you. The only part that you will need to change is the source control repo:</p>
<pre style="background-color:#2b303b;">
<code class="language-bash" data-lang="bash"><span style="color:#bf616a;">ac_add_options --with-app-name</span><span style="color:#c0c5ce;">=${</span><span style="color:#bf616a;">binName</span><span style="color:#c0c5ce;">}
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_USER_DIR</span><span style="color:#c0c5ce;">=&quot;$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">name</span><span style="color:#a3be8c;">}</span><span style="color:#c0c5ce;">&quot;
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_APP_VENDOR</span><span style="color:#c0c5ce;">=&quot;$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">vendor</span><span style="color:#a3be8c;">}</span><span style="color:#c0c5ce;">&quot;
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_APP_BASENAME</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">binName</span><span style="color:#a3be8c;">}
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_APP_PROFILE</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">binName</span><span style="color:#a3be8c;">}
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_APP_DISPLAYNAME</span><span style="color:#c0c5ce;">=&quot;$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">name</span><span style="color:#a3be8c;">}</span><span style="color:#c0c5ce;">&quot;
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_MACBUNDLE_ID</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">appId</span><span style="color:#a3be8c;">}
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_DISTRIBUTION_ID</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">appId</span><span style="color:#a3be8c;">}

</span><span style="color:#65737e;"># Uncomment if builds are too resource hungry
# mk_add_options MOZ_MAKE_FLAGS=&quot;-j4&quot;
# ac_add_options --enable-linker=gold

# Misc
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_STUB_INSTALLER</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_INCLUDE_SOURCE_INFO</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">1
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_SOURCE_REPO</span><span style="color:#c0c5ce;">=</span><span style="color:#a3be8c;">https://github.com/dothq/browser-desktop </span><span style="color:#65737e;"># &lt;-- Change this!
</span><span style="color:#b48ead;">export </span><span style="color:#bf616a;">MOZ_SOURCE_CHANGESET</span><span style="color:#c0c5ce;">=$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">changeset</span><span style="color:#a3be8c;">}
</span></code></pre>
<p>This directory is also where you would put <a href="/guides/branding">branding assets for your browser</a></p>
<h2 id="src">src/</h2>
<p>The source folder contains all of the modifications that you have made to Firefox. These come in two types, inserted files (and folders) and patches. Both of these are applied using the <code>gluon import</code> command.</p>
<p>Inserted files are just files (and folders) that you have inserted into the Firefox source code. These will overwrite existing files if they already exist. On Linux and MacOS, these are symlinked so when you change a file in <code>src/</code>, the change will be mirrored in Firefox's source code instantly. On Windows, you will need to run <code>gluon import</code> for these changes to apply.</p>
<p>Patches are changes to Firefox's files. As a rule of thumb, you should prefer splitting new content into a new file rather than using patches, but there are times when you must modify Firefox's source code. Each of these patch files are just git patch files:</p>
<pre style="background-color:#2b303b;">
<code class="language-patch" data-lang="patch"><span style="color:#c0c5ce;">diff --git a/browser/themes/linux/jar.mn b/browser/themes/linux/jar.mn
index 404a88b218c652afac0cb2004676d22da53d48f3..5a4668ef2970dd773536907f51f3e7e7e3e023cb 100644
--- a/browser/themes/linux/jar.mn
+++ b/browser/themes/linux/jar.mn
@@ -6,7 +6,7 @@ </span><span style="color:#8fa1b3;">browser.jar:
</span><span style="color:#c0c5ce;"> % skin browser classic/1.0 %skin/classic/browser/
 #include ../shared/jar.inc.mn
   skin/classic/browser/sanitizeDialog.css
</span><span style="color:#bf616a;">-  skin/classic/browser/browser.css
</span><span style="color:#a3be8c;">+* skin/classic/browser/browser.css
</span><span style="color:#c0c5ce;">   skin/classic/browser/contextmenu.css                (../shared/contextmenu.css)
   skin/classic/browser/monitor-base.png
   skin/classic/browser/monitor-border.png
</span></code></pre>
<p>In this patch, you can see that I am adding a <code>*</code> to the start of a line. You generate these patches by modifying the file in the <code>engine/</code> directory and running <code>gluon export</code> to export your changes to the src directory. Be careful, if you do not export your changes, they will not be saved and will not work on other developer's computers or yours after an update!</p>
<pre style="background-color:#2b303b;">
<code class="language-sh" data-lang="sh"><span style="color:#bf616a;">gluon</span><span style="color:#c0c5ce;"> export browser/themes/linux/jar.mn
</span></code></pre><h2 id="engine">engine/</h2>
<p>The engine directory contains all of Firefox's source code. It is massive - around 15GB in size (around 11GB of that are build assets from when you run <code>gluon build</code>). I am not able to provide a full explanation of the contents of the directory.</p>
<p>However, most of the changes you will want to make will be in <code>engine/browser/</code>, which contains the source code for the browser's UI. Here are some of the important directories inside of the <code>engine/browser/</code> directory:</p>
<ul>
<li><a href="https://searchfox.org/mozilla-central/source/browser/base/content"><code>engine/browser/base/content</code></a>: These contain the xhtml files that make up a majority of the browser's ui</li>
<li><a href="https://searchfox.org/mozilla-central/source/browser/components"><code>engine/browser/components</code></a>: This contains some self-contained UI features, like screenshots, uitours, downloads, etc.</li>
<li><a href="https://searchfox.org/mozilla-central/source/browser/themes"><code>engine/browser/themes</code></a>: Here lies most of the browsers CSS. See <a href="/getting-started/userchrome">Customizing Your Browser's UI</a> for more information.</li>
</ul>
<p>One of the best ways to find what you are looking for and get to know the code base is by searching it. However, if you try and search through it on your computer you are in for a world of pain. Instead, I recommend you use <a href="https://searchfox.org">SearchFox</a>, which is significantly faster.</p>
 
  </div>

</article>
</main>

  
  <script type="text/javascript" src="https://docs.gluon.dev/elasticlunr.min.js" defer></script>
  <script type="text/javascript" src="https://docs.gluon.dev/search_index.en.js" defer></script>
  <script type="text/javascript" src="https://docs.gluon.dev/js.js" defer></script>
  

</body>
</html>
